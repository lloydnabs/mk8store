language: cpp
sudo: required

os: linux
dist: xenial

env:
  global:
    - DEVKITPRO=/opt/devkitpro
    - DEVKITPPC=/opt/devkitpro/devkitPPC
    - WUT_ROOT=/opt/devkitpro/wut

matrix:
  include:
    - env: PLATFORM=wiiu
  allow_failures:
    - env: PLATFORM=wiiu

addons:
  apt:
    packages:
      - git
      - wget

install:
  - ./dependency_helper.sh

script:
  - make -f Makefile.${PLATFORM}

before_deploy:

- mkdir -p "wiiu/apps/mk8store"

- versiontag="0.1"

- cp appstore.rpx wiiu/apps/sdcafiine

- zip -r mk8store.zip wiiu
deploy:

  provider: releases

  skip_cleanup: true

  api_key:

    secure: "d4023e375a028a7c96907ab0847607f3377e1153"

  file: mk8store.zip

  on:

    repo: lloydnabs/mk8store

    tags: false

    all_branches: true